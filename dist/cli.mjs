#!/usr/bin/env node
var pe=Object.defineProperty;var m=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var ce=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),me=(e,t)=>{for(var r in t)pe(e,r,{get:t[r],enumerable:!0})};var V=ce((It,qe)=>{qe.exports={name:"icon-components",version:"1.9.8",description:"Generate Icon Components",main:"index.js",bin:"dist/cli.js",scripts:{test:"npm run build && npm run test:jest && npm run test:all","test:jest":"jest --verbose","test:typescript":"sh test/scripts/typescript.sh","test:external":"sh test/scripts/external.sh","test:react":"sh test/scripts/react.sh","test:stencil":"sh test/scripts/stencil.sh","test:lists":"sh test/scripts/lists.sh","test:templates":"sh test/scripts/templates.sh","test:cleanup":"sh test/scripts/cleanup.sh","test:copy":"sh test/scripts/copy.sh","test:prependline":"sh test/scripts/prependLine.sh","test:iconfolder":"sh test/scripts/iconFolder.sh","test:all":"npm run test:lists && npm run test:templates && npm run test:cleanup && npm run test:react && npm run test:stencil && npm run test:external && npm run test:copy && npm run test:prependline && npm run test:iconfolder",build:"tsup",lint:"eslint --ext .js,.ts --ignore-path .gitignore .","lint:fix":"eslint --ext .js,.ts --ignore-path .gitignore . --fix",docs:"npx gieter","docs:local":"node ../gieter/dist/index.js",dev:"tsc -w",prepublishOnly:"npm run test"},repository:{type:"git",url:"git+https://github.com/silvandiepen/icon-components.git"},keywords:["stencil","icons","svg","components","generate"],author:"Sil van Diepen",license:"MIT",bugs:{url:"https://github.com/silvandiepen/icon-components/issues"},homepage:"https://github.com/silvandiepen/icon-components#readme",dependencies:{"@sil/case":"^0.0.3","cli-block":"^1.3.8",ejs:"^3.1.8",kleur:"^4.1.5",mkdirp:"^1.0.4",prettier:"^2.7.1",rimraf:"^3.0.2",svgo:"^2.8.0",yargs:"^17.5.1"},devDependencies:{"@types/ejs":"^3.1.1","@types/jest":"^28.1.6","@types/node":"^18.6.2","@types/svgo":"^2.6.3","@typescript-eslint/eslint-plugin":"^5.31.0","@typescript-eslint/parser":"^5.31.0","@zerollup/ts-transform-paths":"^1.7.18",chai:"^4.3.6",eslint:"^8.20.0","eslint-config-prettier":"^8.5.0","eslint-plugin-import":"^2.26.0","eslint-plugin-prettier":"^4.2.1",jest:"^28.1.3","ts-jest":"^28.0.7","ts-node":"^10.9.2","tsc-alias":"^1.8.8",tslint:"^6.1.1",tsup:"^8.0.2",typescript:"^4.7.4"},engines:{npm:">=7.0.0",node:">=16.0.0"}}});import fr from"rimraf";import{blockFooter as yt}from"cli-block";import{join as ve,basename as Y,extname as be}from"path";import{blockLineError as Se}from"cli-block";import{kebabCase as Fe,PascalCase as K}from"@sil/case";import{join as ge,extname as G}from"path";import{kebabCase as Te}from"@sil/case";var R={};me(R,{WAIT:()=>k,asyncForEach:()=>n,asyncRemoveAttrs:()=>$,asyncRemoveTags:()=>g,createAFolder:()=>q,dirExist:()=>A,fileName:()=>l,fixJsx:()=>xe,formatFile:()=>h,getAttrData:()=>L,getExtension:()=>c,getTagData:()=>j,prefixedName:()=>T,removeAttrs:()=>ue,removeStyle:()=>d,removeTags:()=>P,svgOnly:()=>u});import f from"path";import{existsSync as ye}from"fs";import{format as fe}from"prettier";import{kebabCase as D}from"@sil/case";var{mkdir:de}=m("fs").promises,k=async(e=0)=>new Promise(t=>{setTimeout(()=>{t("resolved")},e)}),n=async(e,t)=>{for(let r=0;r<e.length;r++)await t(e[r],r,e)},l=(e,t=null)=>t?`${t.prefix}${f.basename(e).replace(".template","").replace(f.extname(e),"")}`:`${f.basename(e).replace(".template","").replace(f.extname(e),"")}`,W=e=>new RegExp(`<[/]{0,1}(${e}|${e})[^><]*>`,"g"),P=(e,t)=>(t.forEach(r=>{e=e.replace(W(r),"")}),e),g=async(e,t)=>(await n(t,r=>{e=e.replace(W(r),"")}),e),B=e=>new RegExp(` ${e}="[^"]*"`,"gi"),ue=(e,t)=>(t.forEach(r=>{e=e.replace(B(r),"")}),e),$=async(e,t)=>(await n(t,r=>{e=e.replace(B(r),"")}),e),d=e=>e.replace(/<style.*?>.*?<\/style>/ig,""),u=e=>e.substring(e.indexOf("<svg"),e.indexOf("</svg>")+6),T=(e,t)=>t===""?D(l(e)):t?`${t}-${D(l(e))}`:`icon-${D(l(e))}`,c=e=>{let t=f.basename(e.replace(".template","")).split(".");return t[0]="",t.join(".")},xe=e=>e.replaceAll("fill-rule","fillRule").replaceAll("clip-rule","clipRule").replace("xlink:href","xlinkHref").replace("xmlns:xlink","xmlnsXlink"),q=async e=>{try{await de(e,{recursive:!0,mode:509})}catch{console.log(`error creating folder ${e}`)}},j=(e,t)=>{let r=new RegExp(`<${t}>(.|
)*?</${t}>`,"gi"),a=e.match(r);return a?P(a[0],[t]):""},L=(e,t)=>{let r=new RegExp(`${t}="(.|
)*?"`,"gi"),a=e.match(r);return a?P(a[0],[t]):""},h=(e,t)=>{let r=null;if(["scss","css","less","graphql","html","vue","yaml","mdx"].includes(t))r=t;else switch(t){case"js":case"jsx":r="babel";break;case"ts":case"tsx":r="typescript";break;case"json":r="json5";break;case"md":r="markdown";break}return r?fe(e,{parser:r}):e},A=e=>{try{return!!ye(e)}catch{return!1}};var M=m("fs").promises,H=(e,t,r)=>{let a=j(r,"style"),s=e.styles?e.styles.find(o=>o.name===t):null;return{data:a+(s?s.data:""),ext:"css"}},he=async e=>{let t=e.styleDir?e.styleDir:e.src;if(!A(t))return[];let r=await M.readdir(t),a=[];return await n(r,async s=>{if(![".css",".scss",".sass",".less",".stylus"].includes(G(s)))return;let o=await M.readFile(ge(t,s)).then(p=>p.toString());a.push({name:Te(l(s)).replace(e.removePrefix,""),extension:G(s),data:o||""})}),a},J=async e=>{try{let t=await he(e).then(r=>r);return{...e,styles:t}}catch(t){console.log(t)}};import w from"path";var y=m("fs").promises,we=async e=>{if(!e.type)return;let t=[];try{let r=await y.readdir(w.join(__dirname,"../../src/templates",e.type));return await n(r,async a=>{let s=await y.readFile(w.join(__dirname,"../../src/templates/",e.type,a));t.push({file:a,data:s.toString()})}),t}catch{console.error("Type does not exist")}},X=async e=>{if(e.template==null)return await we(e);let t=[];if((await y.lstat(e.template)).isDirectory()){let a=await y.readdir(e.template);await n(a,async s=>{let o=await y.readFile(w.join(e.template,s));t.push({file:s,data:o.toString()})})}else{let a=await y.readFile(w.join(e.template));t.push({file:e.template,data:a.toString()})}return t};var Q=m("fs").promises,U=async e=>(e=await J(e),e=await De(e),e),De=async e=>{try{let t=await $e(e).then(a=>a),r=await X(e).then(a=>a);return e.filter&&(t=t.filter(a=>a.name.includes(e.filter))),{...e,files:t,templates:r}}catch(t){console.log(t)}},ke=async(e,t)=>{try{return Q.readFile(ve(e.src,t)).then(r=>r.toString())}catch(r){console.warn(r)}},Pe=e=>{let t=L(e,"viewbox").replace(/[^\d. ]/g,"").split(" ");return t.length!==4&&Se("Some file does not have a viewbox"),{width:parseInt(t[2],10),height:parseInt(t[3],10)}},$e=async e=>{let t=await Q.readdir(e.src),r=[];return await n(t,async a=>{if(be(a)!==".svg")return;let s=await ke(e,a).then(u),o=await $(e.svgOnly?u(s):s,e.removeAttrs),p=await g(e.svgOnly?u(s):s,e.removeTags),N=await g(o,e.removeTags),z=Fe(l(a)).replace(e.removePrefix,""),oe=H(e,z,s),{width:ne,height:le}=Pe(s);r.push({og_name:a,name:z,title:K(Y(a)),title_lowercase:Y(a).toLowerCase(),fileName:T(a,e.prefix),componentName:K(T(a,e.prefix)),data:e.removeStyle?d(s):s,data_clean:{attrs:e.removeStyle?d(o):o,tags:e.removeStyle?d(p):p,both:e.removeStyle?d(N):N},width:ne,height:le,style:oe})}),r};import{join as x,dirname as je}from"path";import{render as Ee}from"ejs";import{red as E,yellow as Ce,blue as v,bold as _e}from"cli-block";import{kebabCase as Z,PascalCase as Oe,upperSnakeCase as Ie}from"@sil/case";import{blockHeader as Ne,blockLineError as ze,blockLineSuccess as We,blockMid as C,blockRowLine as Be,blockSettings as Me}from"cli-block";var{mkdir:Le,stat:Ae,writeFile:Re}=m("fs").promises,Ge=V(),He=async e=>{let t=je(e);if((await Ae(t)).isDirectory())return!0;Le(t)},b=async(e,t)=>{let r=t.dest?t.dest:e.dest,a=x(r,t.name+(t.ext?t.ext:"")),s=e.prependLine?`${e.prependLine}
${t.data}`:t.data;try{await He(a),await Re(a,s,{encoding:"utf8",flag:"w"})}catch(o){console.log(o)}},Je=async(e,t,r)=>Ee(t.data,{...r,...e,...R,PascalCase:Oe,kebabCase:Z,upperSnakeCase:Ie}),Xe=async function(e,t){await n(e.templates,async r=>{try{let a=await Je(t,r,e),s=c(r.file);if(await b(e,{data:h(a,s),ext:s,name:Z(l(t.name)),dest:e.dest}),We(`${t.name}${v(c(r.file))}${t.style?` ${v("+ style")}`:""}`),!(!e.inRoot&&e.parentIndex))return;let o=`export * from "./${t.name}";`,p=[".ts",".tsx"].includes(s)?".ts":".js";await b(e,{data:h(o,p),ext:p,name:"index",dest:e.dest})}catch(a){ze(`${t.name}${v(c(r.file))} ${a}`)}})},Ye=async e=>{if(Ne(`Generating Icons - ${Ge.version}`),C("Settings"),e.src&&e.dest){let t={destination:e.dest,source:e.src,prefix:e.prefix,template:e.template?e.template:e.type,optimize:e.optimize,removeOld:e.removeOld,removeAttrs:e.removeAttrs,removeTags:e.removeTags,removeStyle:e.removeStyle,list:e.list?e.list:!1,listTemplate:e.listTemplate?e.listTemplate:!1,index:e.index?e.index:!1,indexTemplate:e.indexTemplate?e.indexTemplate:!1,types:e.types?e.types:!1,typesTemplate:e.typesTemplate?e.typesTemplate:!1,parentIndex:e.parentIndex?e.parentIndex:!1,totalFiles:e.files.length,iconFolder:e.iconFolder?e.iconFolder:!1,inRoot:e.inRoot?e.inRoot:!1};await Me(t),e.files.length<1&&(C("Warnings"),Be(["src",`${Ce().italic(e.src)} ${E("Your source folder doesn't contain any")+E().bold(" .svg ")+E("files.")}`,""]))}},Ke=async e=>{e.files.length>0&&(C(`${_e("Files")} ${v().bold("("+e.files.length+")")}`),await n(e.files,async t=>{let r=x(e.dest);e.iconFolder&&!e.inRoot?r=x(e.dest,e.iconFolder,l(t.name)):e.inRoot?e.iconFolder&&(r=x(e.dest,e.iconFolder)):r=x(e.dest,l(t.name)),await q(r),Xe({...e,dest:r},t)})),await k(100)},ee=async e=>(await Ye(e),await Ke(e),e);import{lstat as Qe,copyFile as te}from"fs/promises";import{basename as Ue,join as S}from"path";import{blockLineSuccess as re}from"cli-block";var ae=async e=>{await n(e.copy,async t=>{let r=t.includes("=")?t.split("=")[0]:t,a=t.includes("=")?t.split("=")[1]:Ue(t);if((await Qe(r)).isDirectory()){let o=S(r),p=S(e.dest,r.split("/")[r.split("/").length-1]);await te(o,p),re(`Copied ${a}`)}else{let o=S(r),p=S(e.dest,a);await te(o,p),re(`Copied ${a}`)}})};import{basename as Ve,join as _,extname as Ze}from"path";import{blockErrors as O,blockLineSuccess as et,blockMid as tt}from"cli-block";import{PascalCase as rt,kebabCase as at,upperSnakeCase as st}from"@sil/case";import ot from"ejs";var{readdir:se,readFile:I,lstat:it}=m("fs").promises,nt=async e=>{let t=[];try{let r=await se(_(__dirname,e));return await n(r,async a=>{let s=await I(_(__dirname,e,a));t.push({file:a,data:s.toString()})}),t}catch(r){O(["Couldn't get the template ",r])}},lt=async e=>{let t=[];return await n(e,async r=>{if((await it(r)).isDirectory()){let s=await se(r);try{await n(s,async o=>{let p=await I(_(r,o));t.push({file:o,data:p.toString()})})}catch(o){O(["Couldn't get the template ",o,s])}}else try{let s=await I(r);t.push({file:r,data:s.toString()})}catch(s){O(["Couldn't get the template ",s,r])}}),t},pt=async(e,t="list")=>{let r=[];switch(t){case"list":r=e.listTemplate;break;case"index":r=e.indexTemplate;break;case"types":r=e.typesTemplate;break}if(r[0]==null||r.length<1){let a=`../../src/templates/${t}`;return await nt(a)}return await lt(r)},ct=async(e,t)=>{let r=[];try{await n(t,a=>{r.push({name:l(a.file),ext:c(a.file),data:ot.render(a.data,{...e,PascalCase:rt,kebabCase:at,upperSnakeCase:st})})})}catch(a){console.warn(a)}return r},mt=async(e,t)=>{await n(t,async r=>{await b(e,{...r,name:Ve(r.name).replace(Ze(r.name),"")}),et(r.name)})},F=async(e,t="list")=>{if(!e[t])return;tt(t);let r=await pt(e,t),a=await ct(e,r);await mt(e,a)};import dt from"yargs";var i={src:"",dest:"",styleDir:"",optimize:!0,template:null,inRoot:!1,copy:[],removeOld:!1,removePrefix:"",stripStyle:!1,prefix:"",list:!1,listTemplate:[],type:"",removeStyle:!1,removeAttrs:["fill","id","class"],removeTags:["svg"],svgOnly:!1,index:!1,indexTemplate:[],types:!1,typesTemplate:[],parentIndex:!1,prependLine:"",iconFolder:"",filter:""},ie=()=>{let e=dt.options({src:{required:!0,type:"string",default:i.src,alias:"source"},dest:{required:!0,type:"string",default:i.dest,alias:"destination"},sd:{required:!0,type:"string",default:i.styleDir,alias:"styleDir"},o:{required:!1,type:"boolean",default:i.optimize,alias:"optimize"},t:{required:!1,type:"string",default:i.template,alias:"template"},p:{required:!1,type:"string",default:i.prefix,alias:"prefix"},c:{required:!1,type:"array",default:i.copy,alias:"copy"},l:{required:!1,type:"boolean",default:i.list,alias:"list"},lt:{required:!1,type:"array",default:i.listTemplate,alias:"listTemplate"},ir:{required:!1,type:"boolean",default:i.inRoot,alias:"inRoot"},type:{required:!1,type:"string",default:i.type},ra:{required:!1,type:"array",default:i.removeAttrs,alias:"removeAttrs"},rt:{required:!1,type:"array",default:i.removeTags,alias:"removeTags"},rs:{required:!1,type:"boolean",default:i.removeStyle,alias:"removeStyle"},ro:{type:"boolean",default:i.removeOld,alias:"removeOld"},rp:{type:"string",default:i.removePrefix,alias:"removePrefix"},ss:{type:"boolean",default:i.stripStyle,alias:"stripStyle"},svg:{type:"boolean",default:i.svgOnly,alias:"svgOnly"},idx:{required:!1,type:"boolean",default:i.index,alias:"index"},idxt:{required:!1,type:"array",default:i.indexTemplate,alias:"indexTemplate"},tps:{required:!1,type:"boolean",default:i.types,alias:"types"},tpst:{required:!1,type:"array",default:i.typesTemplate,alias:"typesTemplate"},pidx:{required:!1,type:"boolean",default:i.parentIndex,alias:"parentIndex"},ppl:{required:!1,type:"string",default:i.prependLine,alias:"prependLine"},if:{required:!1,type:"string",default:i.iconFolder,alias:"iconFolder"},ft:{required:!1,type:"string",default:i.filter,alias:"filter"}}).argv;return{src:e.src,dest:e.dest,styleDir:e.sd,optimize:e.o,template:e.t,inRoot:e.ir,copy:e.c,removeOld:e.ro,removePrefix:e.rp,stripStyle:e.ss,prefix:e.p,list:e.lt.filter(Boolean).length>0?!0:e.l,listTemplate:e.lt,type:e.type,removeStyle:e.rs,removeAttrs:e.ra,removeTags:e.rt,svgOnly:e.svg,index:e.idxt.filter(Boolean).length>0?!0:e.idx,indexTemplate:e.idxt,types:e.tpst.filter(Boolean).length>0?!0:e.tps,typesTemplate:e.tpst,parentIndex:e.pidx,prependLine:e.ppl,iconFolder:e.if,filter:e.ft}};U(ie()).then(ee).then(async e=>{await F(e,"list"),await F(e,"index"),await F(e,"types"),e.copy.length>0&&await ae(e)}).then(()=>{yt("Done!")});
//# sourceMappingURL=cli.mjs.map