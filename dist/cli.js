#!/usr/bin/env node
var he=Object.create;var _=Object.defineProperty;var Se=Object.getOwnPropertyDescriptor;var we=Object.getOwnPropertyNames;var Fe=Object.getPrototypeOf,be=Object.prototype.hasOwnProperty;var ke=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),De=(e,t)=>{for(var r in t)_(e,r,{get:t[r],enumerable:!0})},Ae=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of we(t))!be.call(e,o)&&o!==r&&_(e,o,{get:()=>t[o],enumerable:!(i=Se(t,o))||i.enumerable});return e};var P=(e,t,r)=>(r=e!=null?he(Fe(e)):{},Ae(t||!e||!e.__esModule?_(r,"default",{value:e,enumerable:!0}):r,e));var le=ke((ft,_e)=>{_e.exports={name:"icon-components",version:"1.9.17",description:"Generate Icon Components",main:"index.js",bin:"dist/cli.js",scripts:{test:"npm run build && npm run test:jest && npm run test:all","test:jest":"jest --verbose","test:external":"sh test/scripts/external.sh","test:lists":"sh test/scripts/lists.sh","test:templates":"sh test/scripts/templates.sh","test:cleanup":"sh test/scripts/cleanup.sh","test:copy":"sh test/scripts/copy.sh","test:remove":"sh test/scripts/remove.sh","test:prependline":"sh test/scripts/prependLine.sh","test:iconfolder":"sh test/scripts/iconFolder.sh","test:all":"npm run test:lists && npm run test:remove && npm run test:templates && npm run test:cleanup && npm run test:external && npm run test:copy && npm run test:prependline && npm run test:iconfolder",build:"tsup",lint:"eslint --ext .js,.ts --ignore-path .gitignore .","lint:fix":"eslint --ext .js,.ts --ignore-path .gitignore . --fix",docs:"npx gieter","docs:local":"node ../gieter/dist/index.js",dev:"tsc -w",prepublishOnly:"npm run test"},repository:{type:"git",url:"git+https://github.com/silvandiepen/icon-components.git"},keywords:["icons","svg","components","generate"],author:"Sil van Diepen",license:"MIT",bugs:{url:"https://github.com/silvandiepen/icon-components/issues"},homepage:"https://github.com/silvandiepen/icon-components#readme",dependencies:{"@sil/args":"^0.1.0","@sil/case":"^0.0.3","cli-block":"^1.3.8",ejs:"^3.1.8",kleur:"^4.1.5",mkdirp:"^1.0.4",prettier:"^2.7.1",rimraf:"^3.0.2",svgo:"^2.8.0",yargs:"^17.5.1"},devDependencies:{"@types/ejs":"^3.1.1","@types/jest":"^28.1.6","@types/node":"^18.6.2","@types/svgo":"^2.6.3","@typescript-eslint/eslint-plugin":"^5.31.0","@typescript-eslint/parser":"^5.31.0","@zerollup/ts-transform-paths":"^1.7.18",chai:"^4.3.6",eslint:"^8.20.0","eslint-config-prettier":"^8.5.0","eslint-plugin-import":"^2.26.0","eslint-plugin-prettier":"^4.2.1",jest:"^28.1.3","ts-jest":"^28.0.7","ts-node":"^10.9.2","tsc-alias":"^1.8.8",tslint:"^6.1.1",tsup:"^8.0.2",typescript:"^4.7.4"},engines:{npm:">=7.0.0",node:">=16.0.0"}}});var Ve=P(require("rimraf")),ue=require("cli-block");var h=require("path"),ae=require("cli-block"),b=require("@sil/case");var F=require("path"),te=require("@sil/case");var G={};De(G,{CONST_CASE:()=>w,WAIT:()=>I,asyncForEach:()=>l,asyncRemoveAttrs:()=>z,asyncRemoveTags:()=>$,createAFolder:()=>q,dirExist:()=>B,fileName:()=>p,fixJsx:()=>Ce,formatFile:()=>j,getAttrData:()=>M,getExtension:()=>f,getTagData:()=>W,prefixedName:()=>C,removeAttrs:()=>$e,removeFix:()=>v,removeStyle:()=>T,removeTags:()=>N,svgOnly:()=>S});var u=P(require("path")),Q=require("fs"),U=require("prettier"),g=require("@sil/case"),{mkdir:Pe}=require("fs").promises,I=async(e=0)=>new Promise(t=>{setTimeout(()=>{t("resolved")},e)}),l=async(e,t)=>{for(let r=0;r<e.length;r++)await t(e[r],r,e)},p=(e,t=null)=>t?`${t.prefix}${u.default.basename(e).replace(".template","").replace(u.default.extname(e),"")}`:`${u.default.basename(e).replace(".template","").replace(u.default.extname(e),"")}`,V=e=>new RegExp(`<[/]{0,1}(${e}|${e})[^><]*>`,"g"),N=(e,t)=>(t.forEach(r=>{e=e.replace(V(r),"")}),e),$=async(e,t)=>(await l(t,r=>{e=e.replace(V(r),"")}),e),Z=e=>new RegExp(` ${e}="[^"]*"`,"gi"),$e=(e,t)=>(t.forEach(r=>{e=e.replace(Z(r),"")}),e),z=async(e,t)=>(await l(t,r=>{e=e.replace(Z(r),"")}),e),T=e=>e.replace(/<style.*?>.*?<\/style>/ig,""),S=e=>e.substring(e.indexOf("<svg"),e.indexOf("</svg>")+6),C=(e,t)=>t===""?(0,g.kebabCase)(p(e)):t?`${t}-${(0,g.kebabCase)(p(e))}`:`icon-${(0,g.kebabCase)(p(e))}`,f=e=>{let t=u.default.basename(e.replace(".template","")).split(".");return t[0]="",t.join(".")},Ce=e=>e.replaceAll("fill-rule","fillRule").replaceAll("clip-rule","clipRule").replace("xlink:href","xlinkHref").replace("xmlns:xlink","xmlnsXlink"),q=async e=>{try{await Pe(e,{recursive:!0,mode:509})}catch{console.log(`error creating folder ${e}`)}},W=(e,t)=>{let r=new RegExp(`<${t}>(.|
)*?</${t}>`,"gi"),i=e.match(r);return i?N(i[0],[t]):""},M=(e,t)=>{let r=new RegExp(`${t}="(.|
)*?"`,"gi"),i=e.match(r);return i?N(i[0],[t]):""},j=(e,t)=>{let r=null;if(["scss","css","less","graphql","html","vue","yaml","mdx"].includes(t))r=t;else switch(t){case"js":case"jsx":r="babel";break;case"ts":case"tsx":r="typescript";break;case"json":r="json5";break;case"md":r="markdown";break}return r?(0,U.format)(e,{parser:r}):e},B=e=>{try{return(0,Q.existsSync)(e)}catch{return!1}},w=e=>{let t=(0,g.upperSnakeCase)(e);return isNaN(parseInt(t.charAt(0)))?t:`_${t}`},v=(e,t)=>(e.startsWith(t.removePrefix)&&(e=e.replace(t.removePrefix,"")),e.endsWith(t.removeAffix)&&(e=e.replace(t.removeAffix,"")),e.includes(t.removeString)&&(e=e.replace(t.removeString,"")),e);var ee=require("fs").promises,re=(e,t,r)=>{let i=W(r,"style"),o=e.styles?e.styles.find(n=>n.name===t):null;return{data:i+(o?o.data:""),ext:"css"}},je=async e=>{let t=e.styleDir?e.styleDir:e.src;if(!B(t))return[];let r=await ee.readdir(t),i=[];return await l(r,async o=>{if(![".css",".scss",".sass",".less",".stylus"].includes((0,F.extname)(o)))return;let n=await ee.readFile((0,F.join)(t,o)).then(m=>m.toString());i.push({name:v((0,te.kebabCase)(p(o)),e),extension:(0,F.extname)(o),data:n||""})}),i},ie=async e=>{try{let t=await je(e).then(r=>r);return{...e,styles:t}}catch(t){console.log(t)}};var H=P(require("path"));var E=require("fs").promises,oe=async e=>{e.template==null&&(console.error("You need to define a template"),e.template="src/templates/default");let t=[];if((await E.lstat(e.template)).isDirectory()){let i=await E.readdir(e.template);await l(i,async o=>{let n=await E.readFile(H.default.join(e.template,o));t.push({file:o,data:n.toString()})})}else{let i=await E.readFile(H.default.join(e.template));t.push({file:e.template,data:i.toString()})}return t};var se=require("fs").promises,ne=async e=>(e=await ie(e),e=await Ee(e),e),Ee=async e=>{try{let t=await Oe(e).then(i=>i),r=await oe(e).then(i=>i);return e.filter&&(t=t.filter(i=>i.name.includes(e.filter))),{...e,files:t,templates:r}}catch(t){console.log(t)}},Le=async(e,t)=>{try{return se.readFile((0,h.join)(e.src,t)).then(r=>r.toString())}catch(r){console.warn(r)}},Re=e=>{let t=M(e,"viewbox").replace(/[^\d. ]/g,"").split(" ");return t.length!==4&&(0,ae.blockLineError)("Some file does not have a viewbox"),{width:parseInt(t[2],10),height:parseInt(t[3],10)}},Oe=async e=>{let t=await se.readdir(e.src),r=[];return await l(t,async i=>{if((0,h.extname)(i)!==".svg")return;let o=await Le(e,i).then(S),n=await z(e.svgOnly?S(o):o,e.removeAttrs),m=await $(e.svgOnly?S(o):o,e.removeTags),X=await $(n,e.removeTags),K=v((0,b.kebabCase)(p(i)),e),ge=re(e,K,o),{width:Te,height:ve}=Re(o),A=v((0,h.basename)(i),e);r.push({og_name:i,name:K,title:(0,b.PascalCase)(A),title_lowercase:A.toLowerCase(),fileName:C(A,e.prefix),componentName:(0,b.PascalCase)(C(A,e.prefix)),data:e.removeStyle?T(o):o,data_clean:{attrs:e.removeStyle?T(n):n,tags:e.removeStyle?T(m):m,both:e.removeStyle?T(X):X},width:Te,height:ve,style:ge})}),r};var c=require("path"),pe=require("ejs"),k=require("@sil/case");var s=require("cli-block");var{mkdir:Ie,stat:Ne,writeFile:ze}=require("fs").promises,qe=le(),We=async e=>{let t=(0,c.dirname)(e);if((await Ne(t)).isDirectory())return!0;Ie(t)},L=async(e,t)=>{let r=t.dest?t.dest:e.dest,i=(0,c.join)(r,t.name+(t.ext?t.ext:"")),o=e.prependLine?`${e.prependLine}
${t.data}`:t.data;try{await We(i),await ze(i,o,{encoding:"utf8",flag:"w"})}catch(n){console.log(n)}},Me=async(e,t,r)=>(0,pe.render)(t.data,{...r,...e,...G,PascalCase:k.PascalCase,kebabCase:k.kebabCase,upperSnakeCase:w}),Be=async function(e,t){await l(e.templates,async r=>{try{let i=await Me(t,r,e),o=f(r.file);if(await L(e,{data:j(i,o),ext:o,name:(0,k.kebabCase)(p(t.name)),dest:e.dest}),(0,s.blockLineSuccess)(`${t.name}${(0,s.blue)(f(r.file))}${t.style?` ${(0,s.blue)("+ style")}`:""}`),!(!e.inRoot&&e.parentIndex))return;let n=`export * from "./${t.name}";`,m=[".ts",".tsx"].includes(o)?".ts":".js";await L(e,{data:j(n,m),ext:m,name:"index",dest:e.dest})}catch(i){(0,s.blockLineError)(`${t.name}${(0,s.blue)(f(r.file))} ${i}`)}})},Ge=async e=>{if((0,s.blockHeader)(`Generating Icons - ${qe.version}`),(0,s.blockMid)("Settings"),e.src&&e.dest){let t={destination:e.dest,source:e.src,template:e.template?e.template:null};e.removeAttrs.length>0&&(t.removeAttrs=e.removeAttrs),e.removeTags.length>0&&(t.removeTags=e.removeTags),e.removeStyle&&(t.removeStyle=e.removeStyle),e.prefix&&(t.prefix=e.prefix),e.optimize&&(t.optimize=e.optimize),e.stripStyle&&(t.stripStyle=e.stripStyle),e.removeOld&&(t.removeOld=e.removeOld),e.removeAffix&&(t.removeAffix=e.removeAffix),e.removeString&&(t.removeString=e.removeString),e.removePrefix&&(t.removePrefix=e.removePrefix),e.list&&(t.list=e.list),e.listTemplate.length&&(t.listTemplate=e.listTemplate),e.index&&(t.index=e.index),e.indexTemplate.length&&(t.indexTemplate=e.indexTemplate),e.types&&(t.types=e.types),e.typesTemplate.length&&(t.typesTemplate=e.typesTemplate),e.parentIndex&&(t.parentIndex=e.parentIndex),e.iconFolder&&(t.iconFolder=e.iconFolder),e.inRoot&&(t.inRoot=e.inRoot),e.filter&&(t.filter=e.filter),await(0,s.blockSettings)(t),e.files.length<1&&((0,s.blockMid)("Warnings"),(0,s.blockRowLine)(["src",`${(0,s.yellow)().italic(e.src)} ${(0,s.red)("Your source folder doesn't contain any")+(0,s.red)().bold(" .svg ")+(0,s.red)("files.")}`,""]))}},He=async e=>{e.files.length>0&&((0,s.blockMid)(`${(0,s.bold)("Files")} ${(0,s.blue)().bold("("+e.files.length+")")}`),await l(e.files,async t=>{let r=(0,c.join)(e.dest);e.iconFolder&&!e.inRoot?r=(0,c.join)(e.dest,e.iconFolder,p(t.name)):e.inRoot?e.iconFolder&&(r=(0,c.join)(e.dest,e.iconFolder)):r=(0,c.join)(e.dest,p(t.name)),await q(r),Be({...e,dest:r},t)})),await I(100)},me=async e=>(await Ge(e),await He(e),e);var D=require("fs/promises"),d=require("path"),J=require("cli-block");var ce=async e=>{await l(e.copy,async t=>{let r=t.includes("=")?t.split("=")[0]:t,i=t.includes("=")?t.split("=")[1]:(0,d.basename)(t);if((await(0,D.lstat)(r)).isDirectory()){let n=(0,d.join)(r),m=(0,d.join)(e.dest,r.split("/")[r.split("/").length-1]);await(0,D.copyFile)(n,m),(0,J.blockLineSuccess)(`Copied ${i}`)}else{let n=(0,d.join)(r),m=(0,d.join)(e.dest,i);await(0,D.copyFile)(n,m),(0,J.blockLineSuccess)(`Copied ${i}`)}})};var y=require("path"),x=require("cli-block"),R=require("@sil/case");var fe=P(require("ejs"));var{readdir:ye,readFile:Y,lstat:Je}=require("fs").promises,Ye=async e=>{let t=[];try{let r=await ye((0,y.join)(__dirname,e));return await l(r,async i=>{let o=await Y((0,y.join)(__dirname,e,i));t.push({file:i,data:o.toString()})}),t}catch(r){console.log(r)}},Xe=async e=>{let t=[];return await l(e,async r=>{if((await Je(r)).isDirectory()){let o=await ye(r);try{await l(o,async n=>{let m=await Y((0,y.join)(r,n));t.push({file:n,data:m.toString()})})}catch(n){(0,x.blockErrors)(["Couldn't get the template ",n,o])}}else try{let o=await Y(r);t.push({file:r,data:o.toString()})}catch(o){(0,x.blockErrors)(["Couldn't get the template ",o,r])}}),t},Ke=async(e,t="list")=>{let r=[];switch(t){case"list":r=e.listTemplate;break;case"index":r=e.indexTemplate;break;case"types":r=e.typesTemplate;break}if(r[0]==null||r.length<1){let i=`../src/templates/${t}`;return await Ye(i)}return await Xe(r)},Qe=async(e,t)=>{let r=[];try{await l(t,i=>{r.push({name:p(i.file),ext:f(i.file),data:fe.default.render(i.data,{...e,PascalCase:R.PascalCase,kebabCase:R.kebabCase,upperSnakeCase:w})})})}catch(i){console.warn(i)}return r},Ue=async(e,t)=>{await l(t,async r=>{await L(e,{...r,name:(0,y.basename)(r.name).replace((0,y.extname)(r.name),"")}),(0,x.blockLineSuccess)(r.name)})},O=async(e,t="list")=>{if(!e[t])return;(0,x.blockMid)(t);let r=await Ke(e,t),i=await Qe(e,r);await Ue(e,i)};var de=require("@sil/args"),a={src:"",dest:"",styleDir:"",optimize:!0,template:null,inRoot:!1,copy:[],removeOld:!1,removePrefix:"",removeAffix:"",removeString:"",stripStyle:!1,prefix:"",list:!1,listTemplate:[],type:"",removeStyle:!1,removeAttrs:["fill","id","class"],removeTags:["svg"],svgOnly:!1,index:!1,indexTemplate:[],types:!1,typesTemplate:[],parentIndex:!1,prependLine:"",iconFolder:"",filter:""},xe=()=>{let e=(0,de.getArgs)();return{src:e.src||a.src,dest:e.dest||a.dest,styleDir:e.styleDir||a.styleDir,optimize:e.optimize||a.optimize,template:e.template||a.template,inRoot:e.inRoot||a.inRoot,copy:e.copy||a.copy,removeOld:e.removeOld||a.removeOld,removePrefix:e.removePrefix||a.removePrefix,removeAffix:e.removeAffix||a.removeAffix,removeString:e.removeString||a.removeString,stripStyle:e.stripStyle||a.stripStyle,prefix:e.prefix||a.prefix,list:e.list||a.list,listTemplate:e.listTemplate||a.listTemplate,type:e.type||a.type,removeStyle:e.removeStyle||a.removeStyle,removeAttrs:e.removeAttrs||a.removeAttrs,removeTags:e.removeTags||a.removeTags,svgOnly:e.svgOnly||a.svgOnly,index:e.index||a.index,indexTemplate:e.indexTemplate||a.indexTemplate,types:e.types||a.types,typesTemplate:e.typesTemplate||a.typesTemplate,parentIndex:e.parentIndex||a.parentIndex,prependLine:e.prependLine||a.prependLine,iconFolder:e.iconFolder||a.iconFolder,filter:e.filter||a.filter}};ne(xe()).then(me).then(async e=>{await O(e,"list"),await O(e,"index"),await O(e,"types"),e.copy.length>0&&await ce(e)}).then(()=>{(0,ue.blockFooter)("Done!")});
//# sourceMappingURL=cli.js.map