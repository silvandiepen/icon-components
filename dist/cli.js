#!/usr/bin/env node
var Se=Object.create;var q=Object.defineProperty;var be=Object.getOwnPropertyDescriptor;var Fe=Object.getOwnPropertyNames;var ke=Object.getPrototypeOf,De=Object.prototype.hasOwnProperty;var Pe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ae=(e,t)=>{for(var r in t)q(e,r,{get:t[r],enumerable:!0})},$e=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Fe(t))!De.call(e,i)&&i!==r&&q(e,i,{get:()=>t[i],enumerable:!(s=be(t,i))||s.enumerable});return e};var j=(e,t,r)=>(r=e!=null?Se(ke(e)):{},$e(t||!e||!e.__esModule?q(r,"default",{value:e,enumerable:!0}):r,e));var ce=Pe((xt,Ie)=>{Ie.exports={name:"icon-components",version:"1.9.24",description:"Generate Icon Components",main:"index.js",bin:"dist/cli.js",scripts:{test:"npm run build && npm run test:jest && npm run test:all","test:jest":"jest --verbose","test:external":"sh test/scripts/external.sh","test:lists":"sh test/scripts/lists.sh","test:templates":"sh test/scripts/templates.sh","test:cleanup":"sh test/scripts/cleanup.sh","test:copy":"sh test/scripts/copy.sh","test:remove":"sh test/scripts/remove.sh","test:prependline":"sh test/scripts/prependLine.sh","test:iconfolder":"sh test/scripts/iconFolder.sh","test:all":"npm run test:lists && npm run test:remove && npm run test:templates && npm run test:cleanup && npm run test:external && npm run test:copy && npm run test:prependline && npm run test:iconfolder",build:"tsup",lint:"eslint --ext .js,.ts --ignore-path .gitignore .","lint:fix":"eslint --ext .js,.ts --ignore-path .gitignore . --fix",docs:"npx gieter","docs:local":"node ../gieter/dist/index.js",dev:"tsc -w",prepublishOnly:"npm run test","yolo:publish":'npm run build && git commit -am "yolo" && npm version patch && npm publish --access public && git push --follow-tags'},repository:{type:"git",url:"git+https://github.com/silvandiepen/icon-components.git"},keywords:["icons","svg","components","generate"],author:"Sil van Diepen",license:"MIT",bugs:{url:"https://github.com/silvandiepen/icon-components/issues"},homepage:"https://github.com/silvandiepen/icon-components#readme",dependencies:{"@sil/args":"^0.1.0","@sil/case":"^0.0.3","cli-block":"^1.3.8",ejs:"^3.1.8",kleur:"^4.1.5",mkdirp:"^1.0.4",prettier:"^2.7.1",rimraf:"^3.0.2",svgo:"^2.8.0"},devDependencies:{"@types/ejs":"^3.1.1","@types/jest":"^28.1.6","@types/node":"^18.6.2","@types/svgo":"^2.6.3","@typescript-eslint/eslint-plugin":"^5.31.0","@typescript-eslint/parser":"^5.31.0","@zerollup/ts-transform-paths":"^1.7.18",chai:"^4.3.6",eslint:"^8.20.0","eslint-config-prettier":"^8.5.0","eslint-plugin-import":"^2.26.0","eslint-plugin-prettier":"^4.2.1",jest:"^28.1.3","ts-jest":"^28.0.7","ts-node":"^10.9.2","tsc-alias":"^1.8.8",tslint:"^6.1.1",tsup:"^8.0.2",typescript:"^4.7.4"},engines:{npm:">=7.0.0",node:">=16.0.0"}}});var rt=j(require("rimraf")),he=require("cli-block");var w=require("path"),ne=require("cli-block"),k=require("@sil/case");var F=require("path"),se=require("@sil/case");var Y={};Ae(Y,{CONST_CASE:()=>b,WAIT:()=>W,asyncForEach:()=>l,asyncRemoveAttrs:()=>M,asyncRemoveTags:()=>C,createAFolder:()=>L,dirExist:()=>J,dirExists:()=>B,fileName:()=>c,fixJsx:()=>Ee,formatFile:()=>_,getAttrData:()=>H,getExtension:()=>f,getTagData:()=>G,prefixedName:()=>E,removeAttrs:()=>Ce,removeFix:()=>v,removeStyle:()=>T,removeTags:()=>z,svgOnly:()=>S});var x=j(require("path")),U=require("fs"),V=require("prettier"),h=require("@sil/case"),Z=require("fs/promises"),{mkdir:je}=require("fs").promises,W=async(e=0)=>new Promise(t=>{setTimeout(()=>{t("resolved")},e)}),l=async(e,t)=>{for(let r=0;r<e.length;r++)await t(e[r],r,e)},c=(e,t=null)=>t?`${t.prefix}${x.default.basename(e).replace(".template","").replace(x.default.extname(e),"")}`:`${x.default.basename(e).replace(".template","").replace(x.default.extname(e),"")}`,ee=e=>new RegExp(`<[/]{0,1}(${e}|${e})[^><]*>`,"g"),z=(e,t)=>(t.forEach(r=>{e=e.replace(ee(r),"")}),e),C=async(e,t)=>(await l(t,r=>{e=e.replace(ee(r),"")}),e),te=e=>new RegExp(` ${e}="[^"]*"`,"gi"),Ce=(e,t)=>(t.forEach(r=>{e=e.replace(te(r),"")}),e),M=async(e,t)=>(await l(t,r=>{e=e.replace(te(r),"")}),e),T=e=>e.replace(/<style.*?>.*?<\/style>/ig,""),S=e=>e.substring(e.indexOf("<svg"),e.indexOf("</svg>")+6),E=(e,t)=>t===""?(0,h.kebabCase)(c(e)):t?`${t}-${(0,h.kebabCase)(c(e))}`:`icon-${(0,h.kebabCase)(c(e))}`,f=e=>{let t=x.default.basename(e.replace(".template","")).split(".");return t[0]="",t.join(".")},Ee=e=>e.replaceAll("fill-rule","fillRule").replaceAll("clip-rule","clipRule").replace("xlink:href","xlinkHref").replace("xmlns:xlink","xmlnsXlink"),L=async e=>{try{await je(e,{recursive:!0,mode:509})}catch{console.log(`error creating folder ${e}`)}},B=async e=>{try{return await(0,Z.lstat)(e),!0}catch{return!1}},G=(e,t)=>{let r=new RegExp(`<${t}>(.|
)*?</${t}>`,"gi"),s=e.match(r);return s?z(s[0],[t]):""},H=(e,t)=>{let r=new RegExp(`${t}="(.|
)*?"`,"gi"),s=e.match(r);return s?z(s[0],[t]):""},_=(e,t)=>{let r=null;if(["scss","css","less","graphql","html","vue","yaml","mdx"].includes(t))r=t;else switch(t){case"js":case"jsx":r="babel";break;case"ts":case"tsx":r="typescript";break;case"json":r="json5";break;case"md":r="markdown";break}return r?(0,V.format)(e,{parser:r}):e},J=e=>{try{return(0,U.existsSync)(e)}catch{return!1}},b=e=>{let t=(0,h.upperSnakeCase)(e);return isNaN(parseInt(t.charAt(0)))?t:`_${t}`},v=(e,t)=>(e.startsWith(t.removePrefix)&&(e=e.replace(t.removePrefix,"")),e.endsWith(t.removeAffix)&&(e=e.replace(t.removeAffix,"")),e.includes(t.removeString)&&(e=e.replace(t.removeString,"")),e);var re=require("fs").promises,ie=(e,t,r)=>{let s=G(r,"style"),i=e.styles?e.styles.find(n=>n.name===t):null;return{data:s+(i?i.data:""),ext:"css"}},Le=async e=>{let t=e.styleDir?e.styleDir:e.src;if(!J(t))return[];let r=await re.readdir(t),s=[];return await l(r,async i=>{if(![".css",".scss",".sass",".less",".stylus"].includes((0,F.extname)(i)))return;let n=await re.readFile((0,F.join)(t,i)).then(p=>p.toString());s.push({name:v((0,se.kebabCase)(c(i)),e),extension:(0,F.extname)(i),data:n||""})}),s},oe=async e=>{try{let t=await Le(e).then(r=>r);return{...e,styles:t}}catch(t){console.log(t)}};var X=j(require("path"));var O=require("fs").promises,ae=async e=>{e.template==null&&(console.error("You need to define a template"),e.template="src/templates/default");let t=[];if((await O.lstat(e.template)).isDirectory()){let s=await O.readdir(e.template);await l(s,async i=>{let n=await O.readFile(X.default.join(e.template,i));t.push({file:i,data:n.toString()})})}else{let s=await O.readFile(X.default.join(e.template));t.push({file:e.template,data:s.toString()})}return t};var le=require("fs").promises,pe=async e=>(e=await oe(e),e=await _e(e),e),_e=async e=>{try{let t=await Ne(e).then(s=>s),r=await ae(e).then(s=>s);return e.filter&&(t=t.filter(s=>s.og_name.includes(e.filter))),{...e,files:t,templates:r}}catch(t){console.log(t)}},Oe=async(e,t)=>{try{return le.readFile((0,w.join)(e.src,t)).then(r=>r.toString())}catch(r){console.warn(r)}},Re=e=>{let t=H(e,"viewbox").replace(/[^\d. ]/g,"").split(" ");return t.length!==4&&(0,ne.blockLineError)("Some file does not have a viewbox"),{width:parseInt(t[2],10),height:parseInt(t[3],10)}},Ne=async e=>{let t=await le.readdir(e.src),r=[];return await l(t,async s=>{if((0,w.extname)(s)!==".svg")return;let i=await Oe(e,s).then(S),n=await M(e.svgOnly?S(i):i,e.removeAttrs),p=await C(e.svgOnly?S(i):i,e.removeTags),u=await C(n,e.removeTags),Q=v((0,k.kebabCase)(c(s)),e),Te=ie(e,Q,i),{width:ve,height:we}=Re(i),$=v((0,w.basename)(s),e);r.push({og_name:s,name:Q,title:(0,k.PascalCase)($),title_lowercase:$.toLowerCase(),fileName:E($,e.prefix),componentName:(0,k.PascalCase)(E($,e.prefix)),data:e.removeStyle?T(i):i,data_clean:{attrs:e.removeStyle?T(n):n,tags:e.removeStyle?T(p):p,both:e.removeStyle?T(u):u},width:ve,height:we,style:Te})}),r};var y=require("path"),me=require("ejs"),D=require("@sil/case");var a=require("cli-block");var{mkdir:qe,stat:We,writeFile:ze}=require("fs").promises,Me=ce(),Be=async e=>{let t=(0,y.dirname)(e);if((await We(t)).isDirectory())return!0;qe(t)},R=async(e,t)=>{let r=t.dest?t.dest:e.dest;await L(r);let s=(0,y.join)(r,t.name+(t.ext?t.ext:"")),i=e.prependLine?`${e.prependLine}
${t.data}`:t.data;try{await Be(s),await ze(s,i,{encoding:"utf8",flag:"w"})}catch(n){console.log(n)}},Ge=async(e,t,r)=>(0,me.render)(t.data,{...r,...e,...Y,PascalCase:D.PascalCase,kebabCase:D.kebabCase,upperSnakeCase:b}),He=async function(e,t){await l(e.templates,async r=>{try{let s=await Ge(t,r,e),i=f(r.file);if(await R(e,{data:_(s,i),ext:i,name:(0,D.kebabCase)(c(t.name)),dest:e.dest}),(0,a.blockLineSuccess)(`${t.name}${(0,a.blue)(f(r.file))}${t.style?` ${(0,a.blue)("+ style")}`:""}`),!(!e.inRoot&&e.parentIndex))return;let n=`export * from "./${t.name}";`,p=[".ts",".tsx"].includes(i)?".ts":".js";await R(e,{data:_(n,p),ext:p,name:"index",dest:e.dest})}catch(s){(0,a.blockLineError)(`${t.name}${(0,a.blue)(f(r.file))} ${s}`)}})},Je=e=>{let t={};return Object.keys(e).forEach(r=>{let s=e[r];(typeof s=="object"&&s.length>0||(typeof s=="string"||typeof s=="number"||typeof s=="boolean")&&s)&&(t[r]=s)}),t},Ye=async e=>{if((0,a.blockHeader)(`Generating Icons - ${Me.version}`),(0,a.blockMid)("Settings"),e.src&&e.dest){let t={...Je(e),files:e.files.length};await(0,a.blockSettings)(t),e.files.length<1&&((0,a.blockMid)("Warnings"),(0,a.blockRowLine)(["src",`${(0,a.yellow)().italic(e.src)} ${(0,a.red)("Your source folder doesn't contain any")+(0,a.red)().bold(" .svg ")+(0,a.red)("files.")}`,""]))}},Xe=async e=>{e.files.length>0&&((0,a.blockMid)(`${(0,a.bold)("Files")} ${(0,a.blue)().bold("("+e.files.length+")")}`),await l(e.files,async t=>{let r=(0,y.join)(e.dest);e.iconFolder&&!e.inRoot?r=(0,y.join)(e.dest,e.iconFolder,c(t.name)):e.inRoot?e.iconFolder&&(r=(0,y.join)(e.dest,e.iconFolder)):r=(0,y.join)(e.dest,c(t.name)),await L(r),He({...e,dest:r},t)})),await W(100)},ye=async e=>(await Ye(e),await Xe(e),e);var P=require("fs/promises"),g=require("path"),A=require("cli-block");var Ke=e=>typeof e=="string"?e.split(",").map(t=>t.trim()):e.map(t=>t.trim()),de=async e=>{let t=Ke(e.copy);await l(t,async r=>{let s=r.includes("=")?r.split("=")[0]:r,i=r.includes("=")?r.split("=")[1]:(0,g.basename)(r),n=await(0,P.lstat)(s);if((0,A.blockMid)("Copy"),n.isDirectory()){let p=(0,g.join)(s),u=(0,g.join)(e.dest,s.split("/")[s.split("/").length-1]);await(0,P.copyFile)(p,u),(0,A.blockLineSuccess)(`Copied ${i}`)}else{let p=(0,g.join)(s),u=(0,g.join)(e.dest,i);await(0,P.copyFile)(p,u),(0,A.blockLineSuccess)(`Copied ${i}`)}})};var d=require("path"),m=require("cli-block"),N=require("@sil/case");var ge=j(require("ejs"));var{readdir:fe,readFile:K,lstat:Qe}=require("fs").promises,Ue=async e=>{let t=[];try{let r=(0,d.join)(__dirname,e);if(!await B(r)){(0,m.blockLineError)(`The directory ${r} does not exist`);return}let i=await fe(r);return await l(i,async n=>{let p=await K((0,d.join)(__dirname,e,n));t.push({file:n,data:p.toString()})}),t}catch(r){console.log(r)}},Ve=async e=>{let t=[];return await l(e,async r=>{if((await Qe(r)).isDirectory()){let i=await fe(r);try{await l(i,async n=>{let p=await K((0,d.join)(r,n));t.push({file:n,data:p.toString()})})}catch(n){(0,m.blockErrors)(["Couldn't get the template ",n,i])}}else try{let i=await K(r);t.push({file:r,data:i.toString()})}catch(i){(0,m.blockErrors)(["Couldn't get the template ",i,r])}}),t},Ze=async(e,t="list")=>{let r=[];switch(t){case"list":r=e.listTemplate;break;case"index":r=e.indexTemplate;break;case"types":r=e.typesTemplate;break}if(r[0]==null||r.length<1){let s=`../src/templates/${t}`;return await Ue(s)}return await Ve(r)},et=async(e,t)=>{let r=[];try{await l(t,s=>{r.push({name:c(s.file),ext:f(s.file),data:ge.default.render(s.data,{...e,PascalCase:N.PascalCase,kebabCase:N.kebabCase,upperSnakeCase:b})})})}catch(s){console.warn(s)}return r},tt=async(e,t)=>{await l(t,async r=>{await R(e,{...r,name:(0,d.basename)(r.name).replace((0,d.extname)(r.name),"")}),(0,m.blockLineSuccess)(r.name)})},I=async(e,t="list")=>{if(!e[t])return;(0,m.blockMid)(t);let r=await Ze(e,t),s=await et(e,r);await tt(e,s)};var ue=require("@sil/args"),o={src:"",dest:"",styleDir:"",optimize:!0,template:null,inRoot:!1,copy:[],removeOld:!1,removePrefix:"",removeAffix:"",removeString:"",stripStyle:!1,prefix:"",list:!1,listTemplate:[],type:"",removeStyle:!1,removeAttrs:["fill","id","class"],removeTags:["svg"],svgOnly:!1,index:!1,indexTemplate:[],types:!1,typesTemplate:[],parentIndex:!1,prependLine:"",iconFolder:"",filter:""},xe=()=>{let e=(0,ue.getArgs)();return{src:e.src||o.src,dest:e.dest||o.dest,styleDir:e.styleDir||o.styleDir,optimize:e.optimize||o.optimize,template:e.template||o.template,inRoot:e.inRoot||o.inRoot,copy:e.copy||o.copy,removeOld:e.removeOld||o.removeOld,removePrefix:e.removePrefix||o.removePrefix,removeAffix:e.removeAffix||o.removeAffix,removeString:e.removeString||o.removeString,stripStyle:e.stripStyle||o.stripStyle,prefix:e.prefix||o.prefix,list:e.list||o.list,listTemplate:e.listTemplate||o.listTemplate,type:e.type||o.type,removeStyle:e.removeStyle||o.removeStyle,removeAttrs:e.removeAttrs||o.removeAttrs,removeTags:e.removeTags||o.removeTags,svgOnly:e.svgOnly||o.svgOnly,index:e.index||o.index,indexTemplate:e.indexTemplate||o.indexTemplate,types:e.types||o.types,typesTemplate:e.typesTemplate||o.typesTemplate,parentIndex:e.parentIndex||o.parentIndex,prependLine:e.prependLine||o.prependLine,iconFolder:e.iconFolder||o.iconFolder,filter:e.filter||o.filter}};pe(xe()).then(ye).then(async e=>{await I(e,"list"),await I(e,"index"),await I(e,"types"),e.copy.length>0&&await de(e)}).then(()=>{(0,he.blockFooter)("Done!")});
//# sourceMappingURL=cli.js.map